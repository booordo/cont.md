"use strict";var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(){var c=function(){function d(f,g,h,j){_classCallCheck(this,d),this.context=f,this.maxContextWidth=1140,this.contextWidth=1140,this.contextHeight=800,this.cx=g,this.cy=h,this.elements=j,this.sectorAngle=360/j.length,this.innerRadius=150,this.outerRadius=330,this.padding=15,this.width=2*this.outerRadius+this.padding,this.middleRadius=this.innerRadius+(this.outerRadius-this.innerRadius)/2,this.connectorCurveAngle=50,this.connectorCurveLength=40,this.connectorWidth=25,this.connectorStart=this.middleRadius+this.connectorWidth/2,this.connectorEnd=this.middleRadius-this.connectorWidth/2,this.mainGroup=this.context.g(),this.circlePath=[],this._updatePuzzle(),this._updateSize(),this._setEventHandlers()}return _createClass(d,[{key:"_updatePuzzle",value:function _updatePuzzle(){this.context.clear(),this.circlePath=[],this.mainGroup=this.context.g(),this._createSectors(),this.mainGroup.add(this._createCircle())}},{key:"_updateSize",value:function _updateSize(){var f=document.body.clientWidth,g=(f-30)/this.width,h=-(this.contextWidth-f)/2;h=0<h?0:h;var j=-(this.contextHeight-this.contextHeight*g)/2;j=0<j?0:j,f<this.width?(this.mainGroup.transform("T "+h+", "+j+" s"+g),this.context.attr({style:"height: "+this.contextHeight*g+"px"})):(this.mainGroup.transform("T "+h+", "+j),this.context.attr({style:"height: 800px"}))}},{key:"_createSectors",value:function _createSectors(){var f=this;a.forEach(function(g,h){var j=h*f.sectorAngle,l=j+f.sectorAngle;f.mainGroup.add(f._createSector(j,l,g))})}},{key:"_createCircle",value:function _createCircle(){var f="";this.circlePath.forEach(function(q){f+=q+" "});var g=this.context.path(f).attr({fill:"#2A2A2B",stroke:"#fff",strokeWidth:"3px"}),h=g.getBBox(),j=this.context.text(h.x+h.width/2,h.y+h.height/2,"ERP").attr({class:"puzzle__circle-title",fill:"#fff"}),l=j.getBBox();j.transform("T 0 "+(this.cy-l.cy));var m=this.context.text(l.cx,this.cy-l.height/2+10,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u0434\u0435\u043B").attr({class:"puzzle__circle-choice",fill:"#f1c40f"}),n=this.context.text(l.cx,this.cy+l.height/2,"\u0421\u0438\u0441\u0442\u0435\u043C\u044B").attr({class:"puzzle__circle-subtitle",textLength:"185",fill:"#fff"}),o=n.getBBox();n.transform("T "+(this.cx-o.cx)+" 0");var p=this.context.g(g,j,m,n);return p.hover(this._circleHoverInHandler,this._circleHoverOutHandler,p,p),p.click(function(){document.location.href="/erp/erp/"}),p}},{key:"_createSector",value:function _createSector(f,g,h){var s=this,j=(f+g)/2,l=this._getArcPoints(this.outerRadius,f,g),m=this._getArcPoints(this.innerRadius,f,g),n=this._getConnectorPoints(g),o=this._getConnectorPoints(f),p=this._getCircleConnectorPoints(j),q=this.context.g(),r=this.context.path("M "+l.start.x+" "+l.start.y+"\n            A "+this.outerRadius+" "+this.outerRadius+" 0 0 1 "+l.end.x+" "+l.end.y+"\n            L "+n.start.x+" "+n.start.y+"\n            C "+n.guides.start.x+" "+n.guides.start.y+" "+n.guides.end.x+" "+n.guides.end.y+" "+n.end.x+" "+n.end.y+"\n            L "+m.end.x+" "+m.end.y+"\n            A "+this.innerRadius+" "+this.innerRadius+" 0 0 0 "+p.end.x+" "+p.end.y+"\n            C "+p.guides.end.x+" "+p.guides.end.y+" "+p.guides.start.x+" "+p.guides.start.y+" "+p.start.x+" "+p.start.y+"\n            A "+this.innerRadius+" "+this.innerRadius+" 0 0 0 "+m.start.x+" "+m.start.y+"\n            L "+o.end.x+" "+o.end.y+"\n            C "+o.guides.end.x+" "+o.guides.end.y+" "+o.guides.start.x+" "+o.guides.start.y+" "+o.start.x+" "+o.start.y+"\n            Z").attr({fill:"rgba(255,255,255,0.4)",stroke:"#fff",strokeWidth:"3px",class:"puzzle__sector"});return this.circlePath.unshift("A "+this.innerRadius+" "+this.innerRadius+" 0 0 0 "+p.end.x+" "+p.end.y+"\n            C "+p.guides.end.x+" "+p.guides.end.y+" "+p.guides.start.x+" "+p.guides.start.y+" "+p.start.x+" "+p.start.y+"\n            A "+this.innerRadius+" "+this.innerRadius+" 0 0 0 "+m.start.x+" "+m.start.y),this.elements.indexOf(h)==this.elements.length-1&&this.circlePath.unshift("M "+m.end.x+" "+m.end.y),q.add(r),h.title.forEach(function(t,u){var v=s._getPoint(s.cx,s.cy,s.middleRadius-(180<j?20*u:20*-u),f),w=s._getPoint(s.cx,s.cy,s.middleRadius-(180<j?20*u:20*-u),g),x=s.context.text(0,0,t).attr({class:"puzzle__text",textpath:"M "+(180<j?v.x+" "+v.y:w.x+" "+w.y)+" \n                A "+s.middleRadius+" "+s.middleRadius+" 0 0 "+(180>j?0:1)+" "+(180<j?w.x+" "+w.y:v.x+" "+v.y)});x.textPath.attr({"text-anchor":"middle",startOffset:"50%"}),x.node.removeAttribute("x"),x.node.removeAttribute("y"),q.add(x)}),q.hover(this._sectorHoverInHandler,this._sectorHoverOutHandler,q,q),q.click(function(){document.location.href=h.link}),q}},{key:"_getArcPoints",value:function _getArcPoints(f,g,h){return{start:this._getPoint(this.cx,this.cy,f,g),end:this._getPoint(this.cx,this.cy,f,h)}}},{key:"_getConnectorPoints",value:function _getConnectorPoints(f){var g=this._getPoint(this.cx,this.cy,this.connectorStart,f),h=this._getPoint(this.cx,this.cy,this.connectorEnd,f);return{start:g,end:h,guides:this._getConnectorGuidesPoints(g,h,f)}}},{key:"_getCircleConnectorPoints",value:function _getCircleConnectorPoints(f){var g=this._getAngleByArcLength(this.connectorWidth/2,this.innerRadius),h=this._getPoint(this.cx,this.cy,this.innerRadius,f-g),j=this._getPoint(this.cx,this.cy,this.innerRadius,f+g);return{start:h,end:j,guides:this._getConnectorGuidesPoints(h,j,f-90)}}},{key:"_getConnectorGuidesPoints",value:function _getConnectorGuidesPoints(f,g,h){return{start:this._getPoint(f.x,f.y,this.connectorCurveLength,h+this.connectorCurveAngle),end:this._getPoint(g.x,g.y,this.connectorCurveLength,h+180-this.connectorCurveAngle)}}},{key:"_getPoint",value:function _getPoint(f,g,h,j){return{x:f+h*Math.cos(j*Math.PI/180),y:g+h*Math.sin(j*Math.PI/180)}}},{key:"_getAngleByArcLength",value:function _getAngleByArcLength(f,g){return 180*f/Math.PI/g}},{key:"_sectorOnClickHandler",value:function _sectorOnClickHandler(f){location.href(f.element.link)}},{key:"_sectorHoverInHandler",value:function _sectorHoverInHandler(){var j=this,g=this.parent(),h=g.children();h.indexOf(this)!==h.length-1&&g.append(this),Snap.animate(1,1.2,function(l){j.attr({transform:"s"+l})},150,mina.easein),this[0].attr({fill:"#8E44AD"}),this[1].attr({fill:"#fff"}),this[2].attr({fill:"#fff"})}},{key:"_sectorHoverOutHandler",value:function _sectorHoverOutHandler(){var g=this;this.stop(),Snap.animate(1.2,1,function(h){g.attr({transform:"s"+h})},150,mina.easeout),this[0].attr({fill:"rgba(255,255,255,0.4)"}),this[1].attr({fill:"#000"}),this[2].attr({fill:"#000"})}},{key:"_circleHoverInHandler",value:function _circleHoverInHandler(){var j=this,g=this.parent(),h=g.children();h.indexOf(this)!==h.length-1&&g.append(this),Snap.animate(1,1.2,function(l){j.attr({transform:"s"+l})},150,mina.easein)}},{key:"_circleHoverOutHandler",value:function _circleHoverOutHandler(){var g=this;this.stop(),Snap.animate(1.2,1,function(h){g.attr({transform:"s"+h})},150,mina.easeout)}},{key:"_setEventHandlers",value:function _setEventHandlers(){var f=this;window.addEventListener("resize",function(){f._updateSize()})}}]),d}(),a=[{title:["\u0420\u043E\u0437\u043D\u0438\u0447\u043D\u0430\u044F","\u0442\u043E\u0440\u0433\u043E\u0432\u043B\u044F"],link:"/erp/roznichnaya-torgovlya/"},{title:["\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0447\u0435\u0441\u043A\u0438\u0439","\u0443\u0447\u0435\u0442"],link:"/erp/upravlencheskiy-uchet/"},{title:["\u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442","\u0442\u043E\u0440\u0433\u043E\u0432\u043B\u044F"],link:"/erp/internet-torgovlya/"},{title:["\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435","\u043F\u0440\u043E\u0434\u0430\u0436\u0430\u043C\u0438"],link:"/erp/upravlenie-prodazhami/"},{title:["\u0424\u0438\u043D\u0430\u043D\u0441\u043E\u0432\u044B\u0439","\u0443\u0447\u0435\u0442"],link:"/erp/finansovyy-uchet/"},{title:["\u0423\u0447\u0435\u0442","\u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0441\u0442\u0432\u0430"],link:"/erp/uchet-proizvodstva/"}],b=new c(Snap("#puzzle"),570,400,a)})();